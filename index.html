<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menéame Predice</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.0/css/bootstrap.min.css" integrity="sha512-XWTTruHZEYJsxV3W/lSXG1n3Q39YIWOstqvmFsdNEEQfHoZ6vm6E9GK2OrF6DSJSpIbRbi+Nn0WDPID9O7xB2Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <script type="text/template" id="menCommentIds">
       menCommentIds:419002,486660,510728,954563,974261,1044704,1341710,1438520,1478599,1524355,1788010,2865157,2880294,3529410,3613850,3659074,3746151,3762424,3973158,3993410,4039592,4131967,4298771,4634981,4637365,4851282,5035944,5154881,5422140,5473397,5490959,5591354,5704364,5855658,5926336,5984228,6082589,6350305,6495651,6569365,6591494,6739481,6783028,7183404,7191232,7368009,7441089,7503017,7531352,7703119,7749101,7853412,7944281,8110546,8125311,8155812,8155782,8183193,8197519,8206410,8366839,8380966,8474265,8599159,8660241,8710291,8739386,8755345,8836217,8836763,9036991,9048564,9162467,9328216,9346148,9516913,9532819,9540130,9624375,9624477,9647700,9784843,9787692,9821244,9904619,10118270,10164616,10224720,10225265,10305937,10320969,10354627,10386568,10529273,10608148,10619404,10726014,10736067,10775605,10807409,10813182,10910776,10968868,10983135,11193282,11203746,11232461,11272787,11275955,11278898,11314921,11391480,11431872,11538296,11626633,11737501,11752812,11816570,11944874,12030136,12054341,12095319,12135172,12212026,12256824,12255900,12479251,12704231,12841918,12874901,12906870,12926066,12989480,13042013,13074918,13093359,13098964,13145104,13236344,13298846,13313119,13689669,13764396,13969331,13989405,14072532,14112105,14126540,14135453,14286127,14297007,14373104,14460735,14537687,14610804,14681632,14697516,14704450,14774383,14775629,15135511,15135659,15158181,15215609,15481037,15662358,15697137,15702719,15721052,15886962,15893667,15942648,16031584,16287719,16301506,16434266,16445774,16771635,16864995,16933134,17270002,17271856,17437325,17691532,17882379,17945831,18047903,18135206,18390352,18435712,18485490,18923440,19050315,19208712,19286195,19390410,19745317,20679520,21105064,21390383,21510875,21692963,21813789,21864415,21972965,22005898,22015166,22056962,22295240,22436028,23096113,23237713,23263218,23497922,23556705,23726113,23943929,23949247,24003117,24130363,24159669,24268698,24500475,25215577,25612064,25749072,26381036,26548444,26614835,26615200,26703908,26724365,27005496,27037648,27138327,27384164,27473840,27689640,27883282,27980174,28000949,28146802,28287252,28347779,28369910,28761901,28966728,29012252,29064120,29093276,29225754,29342287,29338584,29433143,29433840,29933683,29994818,31003841,31085780,31203994,31653288,31979688,32193132,32281617,32626224,32661938,32777110,32876315,33118802,33590939,33634997,33708259,33775304,33903906,34074130,34190840,34299352,34985613,35284741,35848980,36413050
    </script>

    <script>
        'use strict';

        function getCommentIds() {
            let $container = document.getElementById('menCommentIds');
            let text = $container.innerText.replace('menCommentIds:', '');
            let ids = text.split(',');
            return ids;
        }

        function getRandomCommentId() {
            let comments = getCommentIds();
            let item = comments[Math.floor(Math.random() * comments.length)];
            return item;
        }

        async function displayComment(commentId) {

            let response = await fetch('./predictions/' + commentId + '.json');

            let json = await response.json();

            let url = getUrl(commentId);

            history.replaceState({}, '', url);

            document.getElementById('field-quote').innerHTML   = json.men_description;
            document.getElementById('field-votes').innerText   = json.men_votes;
            document.getElementById('field-karma').innerText   = json.men_karma;
            document.getElementById('field-author').innerText  = json.men_user_id;
            document.getElementById('field-date').innerText    = json.men_pubdate;
            document.getElementById('field-link').href         = json.men_link;
            document.getElementById('field-title').innerText   = json.men_title;
            document.getElementById('field-title').href       = json.men_link;
            document.getElementById('field-random').href       = './?id=' + getRandomCommentId(); 

            document.getElementById('field-share').href        = 'https://www.meneame.net/submit?url=' + encodeURIComponent(url);

        }

        function getUrl(commentId) {
            var href = location.href;
            let url = href.split('?')[0];
            
            url += '?id=' + commentId;
            return url;
        }

        window.addEventListener('load', function() {
            let queryParams = new URLSearchParams(window.location.search);

            let id = queryParams.get('id');
            if (!id) {
                id = getRandomCommentId();
            }
            displayComment(id);
        });

    </script>
</head>
<body>

    <div class="container mt-5">

        <div class="randomlink">
            <a href="" class="randomlink__anchor" id="field-random">
                <i class="randomlink__icon fa fa-shuffle"></i>
                Aleatorio
            </a>
        </div>

        <a class="title" href="" target="_blank" id="field-title">
        </a>

        <div class="clearfix"></div>

        <div class="quote" id="field-quote">
            Menéandola...
        </div>

        <div class="quotefooter">
            <span class="quotefooter__label">v</span> 
            <span class="quotefooter__value" id="field-votes"></span> 
            <span class="quotefooter__pipe">|</span> 
            <span class="quotefooter__label">k</span> 
            <span class="quotefooter__value" id="field-karma"></span> 
            <span class="quotefooter__pipe">|</span> 
            <a href="" class="quotefooter__share" target="_blank" id="field-share">
                <i class="fa fa-share-nodes"></i> compartir
            </a>
        </div>

        <a href="" target="_blank" class="author" id="field-link">
            <span class="author__name" id="field-author"></span>
            -
            <span class="author__date" id="field-date"></span>
        </a>

        <div class="disclaimer">
            Disclaimer: Esta web no está relacionada con Menéame. La tortilla siempre con cebolla.
            Licencia: <a href="https://creativecommons.org/licenses/by/3.0/es/" target="_blank">CC BY 3.0 ES</a>. 
            <a href="https://hnpredictions.github.io/" target="_blank">Inspiración</a>.
        </div>
    </div>

</body>
</html>